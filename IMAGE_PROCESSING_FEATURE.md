# 🖼️ 图片自动压缩和缩放功能

## ✨ 功能说明

在添加/编辑商品时，主图URL字段现在支持**自动压缩和缩放**功能，可以：

1. **自动压缩图片** - 减小文件大小，提高加载速度
2. **自动缩放图片** - 调整到合适尺寸（最大1200×1200px）
3. **保持宽高比** - 自动保持原始图片比例
4. **实时预览** - 显示处理前后的对比信息

## 🎯 使用方法

### 方式一：自动处理（推荐）

1. 在"主图 URL"字段输入图片URL
2. 按 `Enter` 键或点击其他字段（失焦）
3. 系统会自动处理图片
4. 处理完成后，显示处理信息和使用处理后的图片

### 方式二：手动处理

1. 在"主图 URL"字段输入图片URL
2. 点击右侧的 **"🔄 处理图片"** 按钮
3. 等待处理完成

## 📊 处理信息显示

处理完成后，会显示以下信息：

- **原始尺寸** - 图片的原始宽度和高度
- **处理后尺寸** - 压缩后的宽度和高度
- **原始大小** - 原始文件大小（KB/MB）
- **处理后大小** - 压缩后的文件大小（KB/MB）
- **压缩率** - 文件大小减少的百分比

## ⚙️ 处理参数

当前默认设置：
- **最大宽度**: 1200px
- **最大高度**: 1200px
- **压缩质量**: 85%
- **输出格式**: JPEG

## 🔍 功能特点

### ✅ 自动识别
- 自动识别HTTP/HTTPS URL
- 自动识别data URL（已处理的图片）
- 自动处理跨域问题

### 🎨 智能处理
- 保持图片宽高比
- 只压缩超过最大尺寸的图片
- 小图片不会被放大

### 🛡️ 错误处理
- 处理失败时自动使用原始URL
- 友好的错误提示
- 跨域问题提示

## 💡 使用建议

1. **推荐使用HTTP/HTTPS URL**
   - 支持自动压缩和缩放
   - 显示详细的处理信息

2. **已处理的图片（data URL）**
   - 如果输入的是data URL，系统会直接使用
   - 不会重复处理

3. **处理失败的情况**
   - 某些图片服务器不允许跨域访问
   - 此时会使用原始URL
   - 不影响商品添加

## 🚀 技术实现

- 使用 Canvas API 进行图片处理
- 支持跨域图片（CORS）
- 异步处理，不阻塞界面
- 实时显示处理进度

## 📝 注意事项

1. **跨域限制**
   - 某些图片服务器可能不允许跨域访问
   - 如果遇到跨域问题，会使用原始URL

2. **文件大小**
   - 处理后的图片以data URL形式存储
   - 适合中小型图片（<5MB）
   - 超大图片建议先压缩再上传

3. **浏览器兼容性**
   - 需要支持 Canvas API
   - 现代浏览器都支持

## 🎉 优势

- ✅ **提高性能** - 压缩后的图片加载更快
- ✅ **节省带宽** - 减少数据传输量
- ✅ **统一尺寸** - 所有商品图片尺寸一致
- ✅ **用户体验** - 自动处理，无需手动操作
- ✅ **信息透明** - 显示详细的处理信息

